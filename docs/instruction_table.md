# Instruction Table

All opcodes are 7-bit. `funct7` is shown only when it is fixed; `-` means "not used / part of imm".  
Custom-0 uses `OPCODE_CUSTOM0` and Custom-1 uses `OPCODE_CUSTOM1` as defined in `rtl/defines.vh`.

| Type | Name | Opcode | funct3 | funct7 | 功能 |
| --- | --- | --- | --- | --- | --- |
| R | ADD | 0110011 | 000 | 0000000 | 有符号加法 |
| R | SUB | 0110011 | 000 | 0100000 | 有符号减法 |
| R | SLL | 0110011 | 001 | 0000000 | 逻辑左移 |
| R | SLT | 0110011 | 010 | 0000000 | 有符号小于置 1 |
| R | SLTU | 0110011 | 011 | 0000000 | 无符号小于置 1 |
| R | XOR | 0110011 | 100 | 0000000 | 异或 |
| R | SRL | 0110011 | 101 | 0000000 | 逻辑右移 |
| R | SRA | 0110011 | 101 | 0100000 | 算术右移 |
| R | OR | 0110011 | 110 | 0000000 | 或 |
| R | AND | 0110011 | 111 | 0000000 | 与 |
| I | ADDI | 0010011 | 000 | - | 立即数加法 |
| I | SLTI | 0010011 | 010 | - | 有符号小于置 1（立即数） |
| I | SLTIU | 0010011 | 011 | - | 无符号小于置 1（立即数） |
| I | XORI | 0010011 | 100 | - | 立即数异或 |
| I | ORI | 0010011 | 110 | - | 立即数或 |
| I | ANDI | 0010011 | 111 | - | 立即数与 |
| I | SLLI | 0010011 | 001 | 0000000 | 逻辑左移（shamt） |
| I | SRLI | 0010011 | 101 | 0000000 | 逻辑右移（shamt） |
| I | SRAI | 0010011 | 101 | 0100000 | 算术右移（shamt） |
| B | BEQ | 1100011 | 000 | - | 相等分支 |
| B | BNE | 1100011 | 001 | - | 不等分支 |
| B | BLT | 1100011 | 100 | - | 有符号小于分支 |
| B | BGE | 1100011 | 101 | - | 有符号大于等于分支 |
| B | BLTU | 1100011 | 110 | - | 无符号小于分支 |
| B | BGEU | 1100011 | 111 | - | 无符号大于等于分支 |
| U | LUI | 0110111 | - | - | 高位立即数装载 |
| U | AUIPC | 0010111 | - | - | PC 相对高位立即数 |
| J | JAL | 1101111 | - | - | 直接跳转并链接 |
| I | JALR | 1100111 | 000 | - | 间接跳转并链接 |
| I | LW | 0000011 | 010 | - | 32-bit 读取 |
| S | SW | 0100011 | 010 | - | 32-bit 写入 |
| SYS | CSRRW | 1110011 | 001 | - | CSR 读写 |
| SYS | CSRRS | 1110011 | 010 | - | CSR 读并置位 |
| SYS | MRET | 1110011 | 000 | 0011000 | 从异常返回（imm=0x302） |
| R | MUL | 0110011 | 000 | 0000001 | 低 32 位乘法 |
| R | MULH | 0110011 | 001 | 0000001 | 高 32 位有符号乘法 |
| R | MULHSU | 0110011 | 010 | 0000001 | 高 32 位有符号×无符号 |
| R | MULHU | 0110011 | 011 | 0000001 | 高 32 位无符号乘法 |
| R | DIV | 0110011 | 100 | 0000001 | 有符号除法 |
| R | DIVU | 0110011 | 101 | 0000001 | 无符号除法 |
| R | REM | 0110011 | 110 | 0000001 | 有符号取余 |
| R | REMU | 0110011 | 111 | 0000001 | 无符号取余 |
| R | KDOT4.SS | 0001011 | 000 | 0000000 | 4×int8 点积（signed×signed） |
| R | KDOT4.SU | 0001011 | 000 | 0000001 | 4×int8 点积（signed×unsigned） |
| R | KDOT4.UU | 0001011 | 000 | 0000010 | 4×int8 点积（unsigned×unsigned） |
| R | KADD8 | 0001011 | 001 | 0000000 | 4×8-bit 加法（环绕） |
| R | KSUB8 | 0001011 | 001 | 0000001 | 4×8-bit 减法（环绕） |
| R | KADDSAT8 | 0001011 | 001 | 0000010 | 4×8-bit 饱和加法 |
| R | KSUBSAT8 | 0001011 | 001 | 0000011 | 4×8-bit 饱和减法 |
| R | KMAX8 | 0001011 | 010 | 0000000 | 4×8-bit 最大值 |
| R | KMIN8 | 0001011 | 010 | 0000001 | 4×8-bit 最小值 |
| R | KABS8 | 0001011 | 010 | 0000010 | 4×8-bit 绝对值（-128 饱和） |
| R | KAVG8 | 0001011 | 010 | 0000011 | 4×8-bit 平均值 |
| R | KADD16 | 0001011 | 010 | 0000100 | 2×16-bit 加法（环绕） |
| R | KADDSAT16 | 0001011 | 010 | 0000101 | 2×16-bit 饱和加法 |
| I | KSHL8I | 0001011 | 011 | 0000000 | 4×8-bit 逻辑左移 |
| I | KSHR8I | 0001011 | 011 | 0000001 | 4×8-bit 算术右移 |
| I | KSRU8I | 0001011 | 011 | 0000010 | 4×8-bit 逻辑右移 |
| I | KRSHR8I | 0001011 | 011 | 0000011 | 4×8-bit 四舍五入右移 |
| I | KCLAMP8I | 0001011 | 011 | 0000100 | 4×8-bit 夹紧到 [-imm,+imm] |
| R | KPACKB | 0001011 | 100 | 0000000 | 打包低字节 |
| R | KUNPK8L.S | 0001011 | 100 | 0000001 | 低两字节符号扩展 |
| R | KUNPK8H.S | 0001011 | 100 | 0000010 | 高两字节符号扩展 |
| R | KPACKH | 0001011 | 100 | 0000011 | 打包低半字 |
| R | KREV8 | 0001011 | 101 | 0000000 | 字节反转 |
| R | KSWAP16 | 0001011 | 101 | 0000001 | 半字交换 |
| R | KRELU8 | 0001011 | 110 | 0000000 | 4×8-bit ReLU |
| R | KACCEL.START | 0101011 | 000 | - | 启动 offload 任务 |
| R | KACCEL.POLL | 0101011 | 001 | - | 轮询任务状态 |
| R | KACCEL.WAIT | 0101011 | 010 | - | 等待任务完成 |
| R | KACCEL.CANCEL | 0101011 | 011 | - | 取消任务并置 ERR |
| R | KACCEL.FENCE | 0101011 | 100 | - | 同步屏障（空操作） |
| R | KACCEL.GETERR | 0101011 | 101 | - | 读取错误状态 |
| R | KACCEL.SETCFG | 0101011 | 110 | - | 设置配置寄存器 |
| R | KACCEL.GETCFG | 0101011 | 111 | - | 读取配置寄存器 |
